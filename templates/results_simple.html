<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ashtakavarga Results - Simple</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }
        
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 15px 15px 0 0;
        }
        
        .btn {
            margin: 5px;
            padding: 10px 20px;
            border-radius: 25px;
        }
        
        .table {
            font-size: 14px;
        }
        
        .table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .tamil-text {
            font-family: 'Tamil', 'Arial Unicode MS', sans-serif;
        }
        
        .planet-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .planet-card h6 {
            color: #495057;
            margin-bottom: 10px;
        }
        
        .planet-values {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 5px;
        }
        
        .planet-value {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 8px;
            text-align: center;
            font-weight: bold;
        }
        
        .planet-value.strong {
            background: #d4edda;
            border-color: #28a745;
        }
        
        .planet-value.moderate {
            background: #fff3cd;
            border-color: #ffc107;
        }
        
        .planet-value.weak {
            background: #f8d7da;
            border-color: #dc3545;
        }
        
        /* Traditional Chart Layout */
        .traditional-chart {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr 1fr;
            gap: 5px;
            max-width: 600px;
            margin: 0 auto;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .chart-house {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .chart-house:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .chart-house.ascendant {
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            color: white;
            border-color: #ff4757;
        }
        
        .chart-house.planets {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
            border-color: #26a69a;
        }
        
        .chart-house.empty {
            background: #f8f9fa;
            color: #6c757d;
            border-color: #dee2e6;
        }
        
        .house-number {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .rasi-name {
            font-size: 14px;
            margin-bottom: 8px;
            font-family: 'Tamil', 'Arial Unicode MS', sans-serif;
        }
        
        .planets-list {
            font-size: 12px;
            line-height: 1.2;
        }
        
        .planet-tag {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 2px 6px;
            margin: 1px;
            border-radius: 10px;
            font-size: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="card">
            <div class="card-header">
                <div class="d-flex justify-content-between align-items-center">
                    <a href="/" class="btn btn-outline-light">Home</a>
                    <div>
                        <h1 class="mb-0">
                            <i class="fas fa-star"></i>
                            <span class="tamil-text">அஷ்டவர்க்க முடிவுகள்</span>
                        </h1>
                        <p class="mb-0 mt-2">Ashtakavarga Results - Simple Version</p>
                    </div>
                    <div>
                        <a href="/dashboard" class="btn btn-outline-light">Dashboard</a>
                        <a href="/matrix-view" class="btn btn-outline-light">Matrix View</a>
                        <a href="/tamil-interpretations" class="btn btn-outline-light">Tamil</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Birth Information -->
        <div class="card">
            <div class="card-body">
                <h3>Birth Information</h3>
                <div id="birthInfo">
                    <!-- Birth info will be populated here -->
                </div>
            </div>
        </div>

        <!-- Native Chart -->
        <div class="card">
            <div class="card-body">
                <h3>Native Chart - Traditional South Indian Layout</h3>
                <div id="nativeChart">
                    <!-- Traditional chart layout -->
                    <div class="traditional-chart">
                        <!-- Top row: Houses 10, 11, 12, 1 -->
                        <div class="chart-house" data-house="10">
                            <div class="house-number">10</div>
                            <div class="rasi-name" id="rasi-10">மகரம்</div>
                            <div class="planets-list" id="planets-10"></div>
                        </div>
                        <div class="chart-house" data-house="11">
                            <div class="house-number">11</div>
                            <div class="rasi-name" id="rasi-11">கும்பம்</div>
                            <div class="planets-list" id="planets-11"></div>
                        </div>
                        <div class="chart-house" data-house="12">
                            <div class="house-number">12</div>
                            <div class="rasi-name" id="rasi-12">மீனம்</div>
                            <div class="planets-list" id="planets-12"></div>
                        </div>
                        <div class="chart-house ascendant" data-house="1">
                            <div class="house-number">1</div>
                            <div class="rasi-name" id="rasi-1">மேஷம்</div>
                            <div class="planets-list" id="planets-1"></div>
                        </div>
                        
                        <!-- Right side: Houses 2, 3 -->
                        <div class="chart-house" data-house="2">
                            <div class="house-number">2</div>
                            <div class="rasi-name" id="rasi-2">ரிஷபம்</div>
                            <div class="planets-list" id="planets-2"></div>
                        </div>
                        <div class="chart-house" data-house="3">
                            <div class="house-number">3</div>
                            <div class="rasi-name" id="rasi-3">மிதுனம்</div>
                            <div class="planets-list" id="planets-3"></div>
                        </div>
                        
                        <!-- Left side: Houses 8, 9 -->
                        <div class="chart-house" data-house="8">
                            <div class="house-number">8</div>
                            <div class="rasi-name" id="rasi-8">விருச்சிகம்</div>
                            <div class="planets-list" id="planets-8"></div>
                        </div>
                        <div class="chart-house" data-house="9">
                            <div class="house-number">9</div>
                            <div class="rasi-name" id="rasi-9">தனுசு</div>
                            <div class="planets-list" id="planets-9"></div>
                        </div>
                        
                        <!-- Bottom row: Houses 4, 5, 6, 7 -->
                        <div class="chart-house" data-house="4">
                            <div class="house-number">4</div>
                            <div class="rasi-name" id="rasi-4">கடகம்</div>
                            <div class="planets-list" id="planets-4"></div>
                        </div>
                        <div class="chart-house" data-house="5">
                            <div class="house-number">5</div>
                            <div class="rasi-name" id="rasi-5">சிம்மம்</div>
                            <div class="planets-list" id="planets-5"></div>
                        </div>
                        <div class="chart-house" data-house="6">
                            <div class="house-number">6</div>
                            <div class="rasi-name" id="rasi-6">கன்னி</div>
                            <div class="planets-list" id="planets-6"></div>
                        </div>
                        <div class="chart-house" data-house="7">
                            <div class="house-number">7</div>
                            <div class="rasi-name" id="rasi-7">துலாம்</div>
                            <div class="planets-list" id="planets-7"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Individual Planet Charts -->
        <div class="card">
            <div class="card-body">
                <h3>Individual Planet Charts</h3>
                <div id="planetCharts">
                    <!-- Planet charts will be populated here -->
                </div>
            </div>
        </div>

        <!-- Sarvashtakavarga -->
        <div class="card">
            <div class="card-body">
                <h3>Sarvashtakavarga</h3>
                <div id="sarvashtakavarga">
                    <!-- Sarvashtakavarga will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Load data from sessionStorage
        function loadResults() {
            try {
                const resultData = JSON.parse(sessionStorage.getItem('ashtakavargaResult'));
                if (!resultData) {
                    console.error('No calculation data found');
                    showNoDataMessage();
                    return;
                }

                populateBirthInfo(resultData);
                populateNativeChart(resultData);
                populatePlanetCharts(resultData);
                populateSarvashtakavarga(resultData);
            } catch (error) {
                console.error('Error loading results:', error);
                showNoDataMessage();
            }
        }

        function showNoDataMessage() {
            document.getElementById('birthInfo').innerHTML = `
                <div class="alert alert-warning">
                    <h4>No Calculation Data Found</h4>
                    <p>Please go to the <a href="/">Home page</a> and perform a calculation first.</p>
                </div>
            `;
        }

        function populateBirthInfo(data) {
            const birthInfo = document.getElementById('birthInfo');
            const info = data.birth_info;
            
            birthInfo.innerHTML = `
                <div class="row">
                    <div class="col-md-3"><strong>Name:</strong> ${info.name}</div>
                    <div class="col-md-3"><strong>Date of Birth:</strong> ${info.dob}</div>
                    <div class="col-md-3"><strong>Time of Birth:</strong> ${info.tob}</div>
                    <div class="col-md-3"><strong>Place:</strong> ${info.place}</div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6"><strong>Coordinates:</strong> ${info.coordinates}</div>
                </div>
            `;
        }

        function populateNativeChart(data) {
            const chart = data.native_chart || [];
            
            // Clear all planets first
            for (let i = 1; i <= 12; i++) {
                const planetsElement = document.getElementById(`planets-${i}`);
                const rasiElement = document.getElementById(`rasi-${i}`);
                const houseElement = document.querySelector(`[data-house="${i}"]`);
                
                if (planetsElement) planetsElement.innerHTML = '';
                if (houseElement) houseElement.className = 'chart-house';
            }
            
            // Populate each house
            chart.forEach(house => {
                const houseNum = house.house;
                const rasiName = house.rasi_name;
                const planets = house.planets || [];
                
                // Update Rasi name
                const rasiElement = document.getElementById(`rasi-${houseNum}`);
                if (rasiElement) {
                    rasiElement.textContent = rasiName;
                }
                
                // Update planets
                const planetsElement = document.getElementById(`planets-${houseNum}`);
                const houseElement = document.querySelector(`[data-house="${houseNum}"]`);
                
                if (planetsElement && houseElement) {
                    if (planets.length > 0) {
                        houseElement.className = 'chart-house planets';
                        planetsElement.innerHTML = planets.map(planet => 
                            `<span class="planet-tag">${planet}</span>`
                        ).join('');
                    } else {
                        houseElement.className = 'chart-house empty';
                        planetsElement.innerHTML = '<span class="planet-tag">Empty</span>';
                    }
                }
            });
            
            // Highlight Ascendant (House 1)
            const ascendantElement = document.querySelector('[data-house="1"]');
            if (ascendantElement) {
                ascendantElement.className = 'chart-house ascendant';
            }
        }

        function populatePlanetCharts(data) {
            const planetCharts = document.getElementById('planetCharts');
            const charts = data.ashtakavarga_charts || {};
            const totals = data.totals || {};
            
            const tamilRasiAbbr = ['மே', 'ரி', 'மி', 'க', 'சி', 'க', 'து', 'வி', 'த', 'ம', 'கு', 'மீ'];
            
            let html = '';
            Object.keys(charts).forEach(planet => {
                const chart = charts[planet].chart || [];
                const total = totals[planet] || 0;
                
                html += `
                    <div class="planet-card">
                        <h6>${planet} - Total: ${total}</h6>
                        <div class="planet-values">
                            ${chart.map((value, index) => {
                                let strengthClass = 'weak';
                                if (value >= 5) strengthClass = 'strong';
                                else if (value >= 3) strengthClass = 'moderate';
                                
                                return `
                                    <div class="planet-value ${strengthClass}">
                                        <div style="font-size: 10px;">${tamilRasiAbbr[index]}</div>
                                        <div>${value}</div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            });
            
            planetCharts.innerHTML = html;
        }

        function populateSarvashtakavarga(data) {
            const sarvashtakavarga = document.getElementById('sarvashtakavarga');
            const sarvaValues = data.sarvashtakavarga || [];
            const sarvaTotal = data.sarva_total || 0;
            
            const tamilRasiAbbr = ['மே', 'ரி', 'மி', 'க', 'சி', 'க', 'து', 'வி', 'த', 'ம', 'கு', 'மீ'];
            
            let html = `
                <div class="text-center mb-3">
                    <h4>Total Sarvashtakavarga: <span class="text-primary">${sarvaTotal}</span></h4>
                </div>
                <div class="planet-values">
                    ${sarvaValues.map((value, index) => {
                        let strengthClass = 'weak';
                        if (value >= 30) strengthClass = 'strong';
                        else if (value >= 25) strengthClass = 'moderate';
                        
                        return `
                            <div class="planet-value ${strengthClass}">
                                <div style="font-size: 10px;">${tamilRasiAbbr[index]}</div>
                                <div>${value}</div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
            
            sarvashtakavarga.innerHTML = html;
        }

        // Load data when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadResults();
        });
    </script>
</body>
</html>
